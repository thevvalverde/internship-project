// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model client {
  id        Int  @default(autoincrement()) @id 
  email     String @unique
  consent   consent[]
}

model consent {
  id              Int              @default(autoincrement()) @id
  description     String
  subjectOption   Boolean
  consentDate     DateTime         @default(now()) @updatedAt
  policy          policy           @relation(fields: [policyID], references: [id])
  policyID        Int
  organization    organization     @relation(fields: [orgReference], references: [id])
  orgReference    Int
  subject         client           @relation(fields: [subjectId], references: [id])
  subjectId       Int
  revokeDate      DateTime?        
  validUntil      DateTime
  consentHistory  consentHistory[]
}

model policy {
  id        Int       @default(autoincrement()) @id 
  policy    String
  consent   consent[]
}

model organization {
  id              Int        @default(autoincrement()) @id
  contactPhone    String
  contactEmail    String
  consent         consent[]
}

model consentHistory {
  id           Int      @default(autoincrement()) @id 
  consent      consent  @relation(fields: [consentID], references: [id])
  consentID    Int
  changedValue Boolean
  timestamp    DateTime @default(now())
}
